!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TaskPort=t():e.TaskPort=t()}(this,(()=>(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function o(e){if("string"!=typeof e||!e.match(/^[\w-.]+$/))throw new Error("Invalid namespace version: "+e);this.version=e,this.functions={},this.register=function(e,t){if(!e.match(/^\w+$/))throw new Error("Invalid function name: "+e);if(e in this.functions)throw new Error(e+" is already used");this.functions[e]=t},this.names=function(){return Object.keys(this.functions)},this.find=function(e){if(e in this.functions)return this.functions[e]}}e.r(t),e.d(t,{createNamespace:()=>p,install:()=>c,register:()=>_});const n={logCallErrors:!1,logInteropErrors:!0};var s=n;const r=new o("unversioned"),i={};function a(e){if(e instanceof Error){const{name:t,message:o,cause:n,stack:s}=e,r=void 0===s?[]:s.split(/\n/).slice(1);return{name:t,message:o,cause:a(n),stackLines:r}}return void 0===e?null:e}function c(e,t){"object"==typeof e&&(s={...n,...e}),void 0===t&&(t=XMLHttpRequest.prototype),t.__elm_taskport_open=t.open,t.open=function(e,t,o,n,s){if(0===t.indexOf("elmtaskport://")){this.__elm_taskport_url=t,this.__elm_taskport_function_call=!0,Object.defineProperty(this,"responseType",{writable:!0}),Object.defineProperty(this,"response",{writable:!0}),Object.defineProperty(this,"status",{writable:!0});const e=function(e){const t=e.match(/^elmtaskport:\/\/([\w-]+\/[\w-]+)?\/([\w]+)\?v=(\d\.\d\.\d)(?:&nsv=([\w.-]+))?$/);if(!t)return;const[o,n,s,r,i]=t;return void 0===n||void 0!==i?{namespaceName:n,namespaceVersion:i,apiVersion:r,functionName:s}:void 0}(t);if(void 0===e)this.__elm_taskport_error=[400,`Cannot decode TaskPort url ${t}. Did you update TaskPort package to a new version, but forgot to update the JavaScript code it requires?`];else{const{namespaceName:t,functionName:o,apiVersion:n,namespaceVersion:s}=e;if("2.0.1"!==n)this.__elm_taskport_error=[400,`TaskPort version conflict. Elm-side is ${n}, but JavaScript-side is 2.0.1. Did you update TaskPort package to a new version, but forgot to update the JavaScript code it requires?`];else if(void 0===t){this.__elm_taskport_function_name=o;const e=r.find(o);void 0!==e?this.__elm_taskport_function=e:this.__elm_taskport_error=[404,`Cannot find function '${o}' in the default namespace. The default namespace has the following functons registered:\n`+r.names().join("\n")]}else if(this.__elm_taskport_function_name=t+"/"+o,t in i){const e=i[t];if(e.version===s){const n=e.find(o);void 0!==n?this.__elm_taskport_function=n:this.__elm_taskport_error=[404,`Cannot find function '${o}' in namespace ${t}. This namespace has only the following functons registered with it:\n`+e.names().join("\n")]}else this.__elm_taskport_error=[400,`The interop call expected namespace '${t}' to have version '${s}', but it is registered with version '${e.version}'. Did you update the Elm package to a new version, but forgot to update the JavaScript code it requires?`]}else{const e=Object.keys(i);this.__elm_taskport_error=[404,`Namespace '${t}' is not registered with TaskPort. Did you follow the instructions to install required JavaScript code for the package? `+(0==e.length)?"There are no namespaces registered with TaskPort.":"Only the following namespaces are known to TaskPort:\n"+e.join("\n")]}}}return this.__elm_taskport_open(e,t,o,n,s)},"function"==typeof ProgressEvent?t.__elm_taskport_dispatch_event=function(e){this.dispatchEvent(new ProgressEvent(e))}:t.__elm_taskport_dispatch_event=t.dispatchEvent,t.__elm_taskport_send=t.send,t.send=function(e){if(!this.__elm_taskport_function_call)return this.__elm_taskport_send(e);if(void 0!==this.__elm_taskport_function){const t=JSON.parse(e);(function(e,t){try{return Promise.resolve(e(t))}catch(e){return Promise.reject(e)}})(this.__elm_taskport_function,t).then((e=>{this.responseType="json",this.response=void 0===e?"null":JSON.stringify(e),this.status=200,this.__elm_taskport_dispatch_event("load")})).catch((e=>{s.logCallErrors&&console.error("JavaScript function "+this.__elm_taskport_function_name+" thrown an error or returned a rejected Promise:",e),this.status=500,this.responseType="json",this.response=JSON.stringify(a(e)),this.__elm_taskport_dispatch_event("load")}))}else{void 0===this.__elm_taskport_error&&this.__elm_taskport_error;const[e,t]=this.__elm_taskport_error;s.logInteropErrors&&console.error("Unable to execute the interop call. "+t),this.status=e,this.responseType="text",this.response=this.__elm_taskport_function_name,this.__elm_taskport_dispatch_event("load")}}}function _(e,t){r.register(e,t)}function p(e,t){const n=new o(t);return i[e]=n,n}return t})()));